# VoiceInput

[English](README.md) | [繁體中文](README.zh-TW.md) | [简体中文](README.zh-CN.md)

VoiceInput 是一款 macOS 上的语音输入工具，让您可以通过语音将文字输入到任何应用程序中。受到 [VoiceInk](https://github.com/Beingpax/VoiceInk) 的启发开发了这款工具，完全免费且自由，不需要授权。

## 功能特色

- **按住说话，放开转写**：使用修饰键（Command、Option、Fn）作为快捷键，按住开始录音，放开后自动将文字插入到当前焦点的输入框
- **实时语音识别**：录音期间实时显示识别结果
- **多语言支持**：支持繁体中文、简体中文、英文、日文
- **灵活的设置**：可自定义快捷键、语言、切换自动插入功能
- **浮动面板**：录音时显示美观的浮动胶囊窗口
- **LLM 智能修正**：内置语言模型处理流程，可自动修正错字与语句不顺
- **自定义词典**：支持个性化词汇替换规则（如将「水平致中」替换为「水平置中」）

## 支持的快捷键

| 快捷键 | 说明 |
|--------|------|
| 右边 Command (⌘) | 默认快捷键 |
| 左边 Command (⌘) | |
| 右边 Option (⌥) | |
| 左边 Option (⌥) | |
| Fn 键 | |

## 系统要求

- macOS 12.0 或更高版本
- 麦克风权限
- 语音识别权限
- 辅助功能权限（用于模拟键盘输入文字）

## 权限说明

首次使用时，系统会要求您授予以下权限：

1. **麦克风权限**：用于录制您的语音
2. **语音识别权限**：用于将语音转换为文字
3. **辅助功能权限**：用于将文字输入到其他应用程序中

## 安装说明

### 从源码编译

1. 克隆项目：

   ```bash
   git clone https://github.com/tenyi/VoiceInput.git
   cd VoiceInput
   ```

2. 使用 Xcode 打开 `VoiceInput.xcodeproj`

3. 在 Xcode 中配置您的开发者签名

4. 编译并运行 (⌘R)

### 配置权限

1. 首次运行后，系统会弹出权限请求对话框，请点击「允许」
2. 若权限被拒绝，可前往 **系统偏好设置 > 隐私与安全性** 手动开启
3. 点击菜单栏中的 VoiceInput 图标，选择「设置」来查看权限状态

## 使用教程

### 基本操作

1. **开始录音**：按住设置的快捷键（例如右边 Command 或 Fn 键）
2. **说话**：对着麦克风说话
3. **停止并输入**：放开快捷键，语音会自动转换为文字并插入到您正在使用的输入框中

### 设置

1. 点击菜单栏中的 VoiceInput 图标
2. 选择「设置」打开设置窗口
3. 您可以设置：
   - **识别语言**：选择语音识别的语言
   - **快捷键**：选择用于触发录音的按键
   - **自动插入**：切换转录完成后是否自动输入文字

## 技术架构

- **语音识别**：
  - **Apple Speech Framework**：macOS 内置的语音识别服务，无需额外设置即可使用
  - **Whisper**：支持本地端 Whisper 模型，可离线使用且识别效果更佳
- **音频处理**：使用 AVAudioEngine 进行录音
- **键盘模拟**：使用 CGEvent 模拟 Cmd+V 粘贴文字
- **快捷键监控**：使用 CGEventTap 监听键盘事件

## 推荐模型

### 联发科 Breeze ASR 模型（繁体中文极力推荐）

对于繁体中文识别，推荐使用联发科（MediaTek）的 Breeze ASR 模型：

**下载链接**：<https://huggingface.co/alan314159/Breeze-ASR-25-whispercpp/tree/main>

**推荐版本**：

- `ggml-model-q4_k.bin`（4 bit 量化）：平衡了模型大小与识别效果，推荐首选
- `ggml-model-q8_k.bin`（8 bit 量化）：如果需要高精度且磁盘空间允许

**使用方法**：

1. 从上述链接下载 `ggml-model-q4_k.bin` 模型文件
2. 打开 VoiceInput 设置
3. 前往「模型」页面
4. 点击「导入模型」并选择下载的模型文件
5. 选择该模型作为 Whisper 引擎

**为什么选择 Breeze ASR**：

- 专为中文语音设计，繁体中文识别效果优异
- 经过 whisper.cpp 优化，可在 Apple Silicon 上高效运行
- 4 bit 量化版本体积小（约 900MB），内存占用低

## LLM 智能修正与自定义词典

除了本地端的语音识别外，VoiceInput 也支持强大的后处理功能，让输入更精准：

### 智能修正 (LLM Correction)

您可以设置 OpenAI 兼容的 API 端点（支持官方 OpenAI、OpenRouter 等各种自定义供应商），让语言模型自动为您修正转录文字的错字。

**💡 强烈推荐使用 `google/gemini-2.5-flash-lite` 模型**：

- **速度极快**：修正步骤造成的延迟时间短
- **价格极便宜**：API 调用成本非常低，是日常大量语音输入的完美选择

### 自定义词典 (User Dictionary)

在设置中的「词典」分页，您可以加入专属的常用词汇替换规则。系统会在最终文字输出前，套用您的自定义词典，确保您的专有名词或特定用语永远正确无误。

## 开发者

- 作者：Tenyi

## 授权

本项目采用 [Apache License 2.0](https://www.apache.org/licenses/LICENSE-2.0) 授权。
